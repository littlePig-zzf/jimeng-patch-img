# 即梦批量文生图插件

这个浏览器插件可以在即梦 AI 文生图页面批量提交提示词并上传参考图，通过悬浮窗口界面实现自动化批量处理。

## 功能特点

- 🎯 **悬浮窗口界面** - 在网页上直接操作，可拖拽移动位置
- ⏱️ **自定义等待时间** - 每个任务可设置3-30秒的等待时间
- 📁 **批量上传参考图** - 支持为每个提示词匹配对应的参考图片
- 📝 **批量输入提示词** - 每行对应一个生图任务
- 🔄 **自动提交流程** - 包括清理旧参考图、上传新参考图、输入提示词、点击生成
- ✅ **连续处理** - 完成一个任务后自动处理下一个

## 使用方法

### 基本流程

1. **安装扩展** - 在Chrome中加载这个扩展
2. **访问即梦** - 打开即梦文生图页面（会自动显示悬浮窗口）
3. **点击插件图标** - 如果悬浮窗口被关闭，点击浏览器工具栏图标重新打开
4. **使用悬浮窗口**：
   - 点击"选择参考图文件夹"选择包含参考图的文件夹（可选）
   - 设置每个任务的等待时间（默认3秒，可自定义3-30秒）
   - 粘贴提示词文本（每行对应一个任务）
   - 点击"开始批量提交"
5. **窗口操作**：
   - **拖拽移动** - 点击标题栏拖动窗口
   - **最小化** - 点击 − 按钮折叠窗口
   - **还原** - 点击 □ 按钮展开窗口
   - **关闭** - 点击 × 按钮关闭窗口
6. **重新打开** - 关闭后点击浏览器工具栏插件图标即可重新打开

## 悬浮窗口功能

### 界面组件
- **可拖拽标题栏** - 移动窗口位置
- **版本显示** - 标题栏显示版本信息
- **参考图选择** - 支持多选参考图文件
- **等待时间设置** - 输入框调整（3-30秒）
- **提示词输入框** - 多行文本输入
- **实时状态显示** - 显示处理进度和步骤状态

### 操作说明
- **拖拽移动**：点击标题栏拖动窗口到任意位置
- **最小化/还原**：点击标题栏的 −/□ 按钮折叠/展开窗口
- **关闭窗口**：点击 × 按钮完全关闭窗口
- **保存设置**：所有设置自动保存到本地存储
- **一键清空**：快速重置所有输入内容

## 自动化流程

插件会自动执行以下步骤：

1. **清理旧参考图** - 移除页面上已有的参考图
2. **上传新参考图** - 上传匹配当前提示词的参考图（如果有）
3. **输入提示词** - 在提示词输入框填入对应文本
4. **点击生成** - 提交生图任务
5. **等待完成** - 使用自定义等待时间
6. **继续下一个** - 重复上述步骤处理下一个提示词

## 文件结构

```
jimeng-batch/
├── manifest.json          # 插件配置文件
├── floating-window.js     # 悬浮窗口实现
├── content.js            # 页面自动化脚本
├── background.js         # 后台脚本（处理图标点击）
├── test-automation.js    # Playwright测试脚本
└── README.md            # 使用说明
```

## 安装步骤

1. 打开Chrome浏览器，访问 `chrome://extensions/`
2. 开启右上角的"开发者模式"
3. 点击"加载已解压的扩展程序"
4. 选择包含这些文件的文件夹

## 准备参考图和提示词

- 将参考图命名为 `001.jpg`, `002.jpg`, `003.jpg` 等
- 准备提示词文本，每行对应一个任务：
  ```
  第一个任务的提示词
  第二个任务的提示词
  第三个任务的提示词
  ```
- 参考图和提示词按顺序一一对应

## 设置等待时间

- **默认3秒** - 适合网络良好环境
- **网络较慢** - 可设置为10-15秒
- **根据任务复杂度** - 调整服务器响应时间

## 故障排除

- **悬浮窗口未显示** - 刷新页面或点击插件图标重新打开
- **提示词输入错误** - 检查控制台输出的调试信息
- **参考图未上传** - 确认图片格式和大小符合要求
- **等待时间过短** - 增加等待时间设置
- **提示词数量不匹配** - 确保每行一个提示词

## 技术实现

插件使用：
- Chrome Extension API
- 原生JavaScript悬浮窗口
- 智能元素定位
- 本地存储设置
- DOM操作和事件触发

## 版本信息

**当前版本：v1.0.0**
- ✅ 支持即梦文生图页面
- ✅ 批量提交提示词
- ✅ 支持参考图自动匹配上传
- ✅ 悬浮窗口交互界面
- ✅ 自动化流程处理
